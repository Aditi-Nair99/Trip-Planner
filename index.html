<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voyager - AI Travel Planner</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Orbitron:wght@400;500;700&family=Rajdhani:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            /* Light Theme Variables */
            --primary-blue: #1a237e;
            --secondary-blue: #283593;
            --accent-blue: #3949ab;
            --light-blue: #5c6bc0;
            --dark-blue: #0d1525;
            --navy-black: #0a0f1c;
            --gold: #ffd700;
            --light-gold: #fff8dc;
            --dark-gold: #ffc400;
            --white: #ffffff;
            --light-gray: #f5f7ff;
            --medium-gray: #e8eaf6;
            --dark-gray: #121a2d;
            --text-dark: #0a0f1c;
            --text-light: #ffffff;
            --shadow: 0 10px 30px rgba(26, 35, 126, 0.15);
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --gradient-bg: linear-gradient(135deg, #0a0f1c 0%, #1a237e 50%, #283593 100%);
            --gradient-card: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            --gradient-accent: linear-gradient(135deg, #ffd700 0%, #ffc400 100%);
        }

        .dark-theme {
            /* Dark Theme Variables */
            --primary-blue: #3949ab;
            --secondary-blue: #283593;
            --accent-blue: #5c6bc0;
            --light-blue: #7986cb;
            --dark-blue: #0d1525;
            --navy-black: #050a14;
            --gold: #ffd700;
            --light-gold: #fff8dc;
            --dark-gold: #ffc400;
            --white: #0a0f1c;
            --light-gray: #121a2d;
            --medium-gray: #1a237e;
            --dark-gray: #f5f7ff;
            --text-dark: #ffffff;
            --text-light: #0a0f1c;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --gradient-bg: linear-gradient(135deg, #050a14 0%, #0d1525 50%, #1a237e 100%);
            --gradient-card: linear-gradient(135deg, #0d1525 0%, #1a237e 100%);
            --gradient-accent: linear-gradient(135deg, #ffd700 0%, #ffc400 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--gradient-bg);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            transition: var(--transition);
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient-card);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .theme-toggle:hover {
            transform: rotate(30deg) scale(1.1);
        }

        .theme-toggle i {
            font-size: 1.5rem;
            color: var(--gold);
        }

        /* Animated Background Elements */
        .bg-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
            pointer-events: none;
        }

        .bg-element {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, var(--light-blue) 0%, transparent 70%);
            opacity: 0.1;
            animation: float 20s infinite linear;
        }

        .bg-element:nth-child(1) {
            width: 300px;
            height: 300px;
            top: -100px;
            left: -100px;
            animation-delay: 0s;
        }

        .bg-element:nth-child(2) {
            width: 200px;
            height: 200px;
            top: 50%;
            right: -50px;
            animation-delay: -5s;
            animation-duration: 25s;
        }

        .bg-element:nth-child(3) {
            width: 150px;
            height: 150px;
            bottom: -50px;
            left: 30%;
            animation-delay: -10s;
            animation-duration: 30s;
        }

        /* Header & Navigation */
        header {
            background: rgba(10, 15, 28, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            border-bottom: 2px solid var(--accent-blue);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--gold) 0%, var(--light-blue) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
        }

        .flight-logo {
            animation: fly 3s infinite ease-in-out;
            font-size: 2.8rem;
            color: var(--gold);
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-links a {
            color: var(--white);
            text-decoration: none;
            font-weight: 500;
            font-size: 1.1rem;
            transition: var(--transition);
            padding: 8px 20px;
            border-radius: 30px;
            position: relative;
            overflow: hidden;
        }

        .nav-links a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .nav-links a:hover::before {
            left: 100%;
        }

        .nav-links a:hover {
            background-color: rgba(255, 215, 0, 0.1);
            transform: translateY(-3px);
            color: var(--gold);
        }

        .auth-buttons {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 12px 28px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--gradient-accent);
            color: var(--navy-black);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.4);
        }

        .btn-secondary {
            background: transparent;
            color: var(--gold);
            border: 2px solid var(--gold);
        }

        .btn-secondary:hover {
            background-color: rgba(255, 215, 0, 0.1);
            transform: translateY(-5px) scale(1.05);
        }

        .btn-small {
            padding: 8px 20px;
            font-size: 0.9rem;
        }

        /* Main Content */
        .main-content {
            padding: 140px 0 60px;
            min-height: calc(100vh - 100px);
        }

        /* Home Page */
        .hero {
            text-align: center;
            margin-bottom: 80px;
            animation: fadeIn 1s ease-out;
            position: relative;
        }

        .hero h1 {
            font-size: 4.5rem;
            font-family: 'Orbitron', sans-serif;
            background: linear-gradient(135deg, var(--gold) 0%, var(--light-blue) 50%, var(--white) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 20px;
            line-height: 1.2;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
            position: relative;
            display: inline-block;
        }

        .hero h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 25%;
            width: 50%;
            height: 3px;
            background: var(--gradient-accent);
            border-radius: 2px;
        }

        .hero p {
            font-size: 1.4rem;
            color: var(--white);
            max-width: 800px;
            margin: 0 auto 50px;
            opacity: 0.9;
        }

        .features-section {
            margin: 100px 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 60px;
        }

        .section-title h2 {
            font-size: 3.5rem;
            color: var(--gold);
            margin-bottom: 20px;
            font-family: 'Rajdhani', sans-serif;
        }

        .section-title p {
            color: var(--white);
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto;
            opacity: 0.9;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            margin-top: 50px;
        }

        .feature-card {
            background: var(--gradient-card);
            border-radius: 20px;
            padding: 40px 30px;
            text-align: center;
            transition: var(--transition);
            border: 2px solid transparent;
            height: 100%;
        }

        .feature-card:hover {
            transform: translateY(-15px);
            border-color: var(--gold);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .feature-icon {
            width: 80px;
            height: 80px;
            background: var(--gradient-accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            font-size: 2rem;
            color: var(--navy-black);
        }

        .feature-card h3 {
            color: var(--gold);
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-family: 'Rajdhani', sans-serif;
        }

        .feature-card p {
            color: var(--white);
            opacity: 0.9;
            line-height: 1.8;
        }

        .destinations-section {
            margin: 100px 0;
        }

        .destinations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .destination-card {
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            height: 300px;
            transition: var(--transition);
        }

        .destination-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .destination-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .destination-card:hover img {
            transform: scale(1.1);
        }

        .destination-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            padding: 30px 20px 20px;
            color: white;
        }

        .destination-overlay h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--gold);
        }

        .destination-overlay p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 50px;
            margin-top: 60px;
            flex-wrap: wrap;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 20px;
            min-width: 200px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-10px);
            border-color: var(--gold);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .stat-card i {
            font-size: 2.5rem;
            color: var(--gold);
            margin-bottom: 15px;
        }

        .stat-card h3 {
            font-size: 2.5rem;
            color: var(--white);
            margin-bottom: 5px;
        }

        .stat-card p {
            color: var(--light-blue);
            font-size: 1rem;
            margin: 0;
        }

        /* Forms */
        .form-container {
            display: none;
            background: var(--gradient-card);
            border-radius: 25px;
            padding: 50px;
            box-shadow: var(--shadow);
            max-width: 500px;
            margin: 0 auto;
            animation: slideUp 0.5s ease-out;
            border: 1px solid rgba(255, 215, 0, 0.2);
            backdrop-filter: blur(10px);
        }

        .form-container.active {
            display: block;
        }

        .form-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .form-header h2 {
            color: var(--gold);
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-family: 'Rajdhani', sans-serif;
        }

        .form-header p {
            color: var(--white);
            opacity: 0.9;
        }

        .form-group {
            margin-bottom: 30px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: var(--gold);
            font-weight: 500;
            font-size: 1.1rem;
        }

        .form-control {
            width: 100%;
            padding: 18px 25px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            font-size: 1rem;
            transition: var(--transition);
            background: rgba(0, 0, 0, 0.2);
            color: var(--white);
            font-family: 'Poppins', sans-serif;
        }

        .form-control::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.2);
            transform: translateY(-2px);
        }

        .form-footer {
            text-align: center;
            margin-top: 30px;
        }

        .form-footer a {
            color: var(--gold);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            position: relative;
        }

        .form-footer a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--gold);
            transition: width 0.3s ease;
        }

        .form-footer a:hover::after {
            width: 100%;
        }

        /* Trip Planner Form */
        #trip-form-container {
            max-width: 900px;
            display: none;
        }

        #trip-form-container.active {
            display: block;
        }

        .form-row {
            display: flex;
            gap: 25px;
            margin-bottom: 30px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .interests-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }

        .interest-tag {
            padding: 12px 25px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            font-weight: 500;
            color: var(--white);
            user-select: none;
        }

        .interest-tag:hover {
            background: rgba(255, 215, 0, 0.1);
            transform: translateY(-3px);
            border-color: var(--gold);
        }

        .interest-tag.selected {
            background: var(--gradient-accent);
            color: var(--navy-black);
            border-color: var(--gold);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 60px 40px;
        }

        .loading.active {
            display: block;
        }

        .loading-content {
            max-width: 600px;
            margin: 0 auto;
        }

        .spinner-container {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 30px;
        }

        .spinner {
            width: 100%;
            height: 100%;
            border: 8px solid rgba(255, 215, 0, 0.1);
            border-top: 8px solid var(--gold);
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
            position: absolute;
            top: 0;
            left: 0;
        }

        .spinner-plane {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
            color: var(--gold);
            animation: bounce 2s infinite ease-in-out;
        }

        .loading h3 {
            color: var(--gold);
            font-size: 1.8rem;
            margin-bottom: 15px;
        }

        .loading p {
            color: var(--white);
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .loading-progress {
            width: 100%;
            height: 5px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin-top: 30px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            width: 0%;
            background: var(--gradient-accent);
            border-radius: 5px;
            animation: progress 2s ease-in-out infinite;
        }

        /* Trip Results */
        #trip-results {
            display: none;
            animation: fadeIn 1s ease-out;
        }

        #trip-results.active {
            display: block;
        }

        .trip-header {
            text-align: center;
            margin-bottom: 50px;
            padding: 40px;
            background: var(--gradient-card);
            border-radius: 25px;
            color: var(--white);
            border: 2px solid rgba(255, 215, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .trip-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--gradient-accent);
        }

        .trip-header h2 {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--gold);
            font-family: 'Rajdhani', sans-serif;
        }

        .trip-header p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 30px;
        }

        .trip-details {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .detail-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            min-width: 180px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            transition: var(--transition);
        }

        .detail-card:hover {
            transform: translateY(-5px);
            border-color: var(--gold);
        }

        .detail-card i {
            font-size: 2rem;
            color: var(--gold);
            margin-bottom: 15px;
        }

        .detail-card p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--light-blue);
        }

        .detail-card strong {
            display: block;
            font-size: 1.3rem;
            color: var(--white);
            margin-top: 5px;
        }

        .itinerary-container {
            margin-top: 50px;
        }

        .day-card {
            background: var(--gradient-card);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            border-left: 5px solid var(--gold);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .day-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .day-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            background: linear-gradient(135deg, transparent 0%, rgba(255, 215, 0, 0.05) 100%);
            z-index: 0;
        }

        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px dashed rgba(255, 215, 0, 0.3);
            position: relative;
            z-index: 1;
        }

        .day-title {
            font-size: 2rem;
            color: var(--gold);
            font-family: 'Rajdhani', sans-serif;
        }

        .day-theme {
            background: rgba(255, 215, 0, 0.1);
            padding: 8px 20px;
            border-radius: 50px;
            color: var(--gold);
            font-weight: 600;
        }

        .day-activities {
            list-style: none;
            position: relative;
            z-index: 1;
        }

        .day-activities li {
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: flex-start;
            gap: 20px;
            transition: var(--transition);
        }

        .day-activities li:hover {
            background: rgba(255, 255, 255, 0.05);
            padding-left: 15px;
            border-radius: 10px;
        }

        .day-activities li:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient-accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--navy-black);
            flex-shrink: 0;
            font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
        }

        .activity-content {
            flex: 1;
        }

        .activity-time {
            font-weight: 600;
            color: var(--gold);
            font-size: 1.1rem;
            display: block;
            margin-bottom: 5px;
        }

        .activity-desc {
            color: var(--white);
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .activity-location {
            color: var(--light-blue);
            font-size: 0.9rem;
        }

        .activity-location i {
            margin-right: 8px;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 60px;
            flex-wrap: wrap;
        }

        /* Previous Trips */
        #previous-trips-container {
            display: none;
        }

        #previous-trips-container.active {
            display: block;
        }

        .trips-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .trips-header h2 {
            font-size: 3rem;
            color: var(--gold);
            margin-bottom: 20px;
            font-family: 'Rajdhani', sans-serif;
        }

        .trips-header p {
            color: var(--white);
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto;
            opacity: 0.9;
        }

        .trips-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .trip-card {
            background: var(--gradient-card);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .trip-card:hover {
            transform: translateY(-10px);
            border-color: var(--gold);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .trip-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--gradient-accent);
        }

        .trip-card h4 {
            color: var(--gold);
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-family: 'Rajdhani', sans-serif;
        }

        .trip-card p {
            margin-bottom: 15px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .trip-card i {
            color: var(--gold);
            width: 20px;
        }

        .trip-date {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--light-blue);
            font-size: 0.9rem;
        }

        .trip-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        /* Footer */
        footer {
            background: var(--navy-black);
            color: var(--white);
            padding: 60px 0 20px;
            margin-top: 80px;
            border-top: 2px solid var(--accent-blue);
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 50px;
            margin-bottom: 50px;
        }

        .footer-section {
            flex: 1;
            min-width: 250px;
        }

        .footer-section h3 {
            font-size: 1.8rem;
            margin-bottom: 30px;
            color: var(--gold);
            font-family: 'Rajdhani', sans-serif;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 15px;
        }

        .footer-links a {
            color: var(--light-blue);
            text-decoration: none;
            transition: var(--transition);
            display: inline-block;
        }

        .footer-links a:hover {
            color: var(--gold);
            transform: translateX(5px);
        }

        .social-icons {
            display: flex;
            gap: 20px;
            margin-top: 25px;
        }

        .social-icons a {
            width: 50px;
            height: 50px;
            background: var(--gradient-card);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.3rem;
            transition: var(--transition);
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .social-icons a:hover {
            background: var(--gradient-accent);
            color: var(--navy-black);
            transform: translateY(-5px);
            border-color: var(--gold);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--light-blue);
            font-size: 0.9rem;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(50px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes bounce {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }

        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(50px, 50px) rotate(90deg); }
            50% { transform: translate(0, 100px) rotate(180deg); }
            75% { transform: translate(-50px, 50px) rotate(270deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }

        @keyframes fly {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(10px) rotate(5deg); }
            50% { transform: translateX(0) rotate(0deg); }
            75% { transform: translateX(-10px) rotate(-5deg); }
        }

        @keyframes progress {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 20px 30px;
            border-radius: 15px;
            color: white;
            font-weight: 500;
            z-index: 1001;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 15px;
            transform: translateX(150%);
            transition: transform 0.5s ease-out;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 400px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.9) 0%, rgba(46, 125, 50, 0.9) 100%);
            border-left: 5px solid #4CAF50;
        }

        .notification.error {
            background: linear-gradient(135deg, rgba(244, 67, 54, 0.9) 0%, rgba(198, 40, 40, 0.9) 100%);
            border-left: 5px solid #f44336;
        }

        .notification.warning {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.9) 0%, rgba(239, 108, 0, 0.9) 100%);
            border-left: 5px solid #ff9800;
        }

        .notification.info {
            background: var(--gradient-card);
            border-left: 5px solid var(--gold);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .hero h1 {
                font-size: 3.8rem;
            }
        }

        @media (max-width: 992px) {
            .hero h1 {
                font-size: 3.2rem;
            }
            
            .nav-links {
                display: none;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .trips-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .hero p {
                font-size: 1.2rem;
            }
            
            .btn {
                padding: 10px 22px;
            }
            
            .stat-card {
                min-width: 150px;
                padding: 20px;
            }
            
            .stat-card h3 {
                font-size: 2rem;
            }
            
            .trip-details {
                flex-direction: column;
                align-items: center;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .form-container {
                padding: 30px;
            }
            
            .footer-content {
                flex-direction: column;
                gap: 30px;
            }
        }

        @media (max-width: 576px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .hero p {
                font-size: 1rem;
            }
            
            .logo {
                font-size: 1.8rem;
            }
            
            .flight-logo {
                font-size: 2rem;
            }
            
            .form-header h2 {
                font-size: 2rem;
            }
        }

        /* Utility Classes */
        .text-center {
            text-align: center;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mt-30 {
            margin-top: 30px;
        }

        .mt-40 {
            margin-top: 40px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .mb-30 {
            margin-bottom: 30px;
        }

        .mb-40 {
            margin-bottom: 40px;
        }

        .hidden {
            display: none !important;
        }

        .pulse {
            animation: pulse 2s infinite ease-in-out;
        }
    </style>
</head>
<body class="dark-theme">
    <!-- Animated Background Elements -->
    <div class="bg-elements">
        <div class="bg-element"></div>
        <div class="bg-element"></div>
        <div class="bg-element"></div>
    </div>

    <!-- Theme Toggle -->
    <div class="theme-toggle" id="theme-toggle">
        <i class="fas fa-moon"></i>
    </div>

    <!-- Header -->
    <header>
        <div class="container">
            <nav>
                <div class="logo-container">
                    <div class="logo">
                        <i class="fas fa-plane flight-logo"></i>
                        Voyager
                    </div>
                </div>
                <ul class="nav-links">
                    <li><a href="#home" id="nav-home">Home</a></li>
                    <li><a href="#features" id="nav-features">Features</a></li>
                    <li><a href="#destinations" id="nav-destinations">Destinations</a></li>
                    <li><a href="#planner" id="nav-planner">Trip Planner</a></li>
                    <li><a href="#trips" id="nav-trips">My Trips</a></li>
                </ul>
                <div class="auth-buttons">
                    <button class="btn btn-secondary btn-small" id="login-btn">Login</button>
                    <button class="btn btn-primary btn-small" id="register-btn">Sign Up</button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Home Page -->
            <section class="home-page" id="home-page">
                <div class="hero">
                    <h1 class="animate__animated animate__fadeInDown">AI-Powered Travel Experiences</h1>
                    <p class="animate__animated animate__fadeInUp">Voyager transforms travel planning with intelligent algorithms that craft perfect journeys. From dream destinations to daily itineraries, we handle every detail so you can focus on making memories.</p>
                    <button class="btn btn-primary animate__animated animate__pulse animate__infinite" id="start-planning-btn">
                        <i class="fas fa-rocket"></i> Launch Your Journey
                    </button>
                    
                    <div class="hero-stats mt-40">
                        <div class="stat-card animate__animated animate__fadeInLeft">
                            <i class="fas fa-globe-americas"></i>
                            <h3>200+</h3>
                            <p>Destinations</p>
                        </div>
                        <div class="stat-card animate__animated animate__fadeInUp">
                            <i class="fas fa-users"></i>
                            <h3>25K+</h3>
                            <p>Happy Travelers</p>
                        </div>
                        <div class="stat-card animate__animated animate__fadeInRight">
                            <i class="fas fa-brain"></i>
                            <h3>AI</h3>
                            <p>Powered Planning</p>
                        </div>
                    </div>
                </div>

                <!-- Features Section -->
                <div class="features-section" id="features">
                    <div class="section-title">
                        <h2>Why Choose Voyager?</h2>
                        <p>Experience the future of travel planning with our cutting-edge features</p>
                    </div>
                    
                    <div class="features-grid">
                        <div class="feature-card animate__animated animate__fadeInUp">
                            <div class="feature-icon">
                                <i class="fas fa-robot"></i>
                            </div>
                            <h3>AI Itinerary Generation</h3>
                            <p>Our intelligent AI creates personalized daily itineraries based on your preferences, budget, and interests.</p>
                        </div>
                        
                        <div class="feature-card animate__animated animate__fadeInUp" style="animation-delay: 0.1s;">
                            <div class="feature-icon">
                                <i class="fas fa-save"></i>
                            </div>
                            <h3>Trip Saving & Storage</h3>
                            <p>Save all your planned trips securely. Access your travel history anytime, anywhere.</p>
                        </div>
                        
                        <div class="feature-card animate__animated animate__fadeInUp" style="animation-delay: 0.2s;">
                            <div class="feature-icon">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <h3>PDF Export</h3>
                            <p>Download your complete itinerary as a beautifully formatted PDF for offline access.</p>
                        </div>
                        
                        <div class="feature-card animate__animated animate__fadeInUp" style="animation-delay: 0.3s;">
                            <div class="feature-icon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <h3>Smart Recommendations</h3>
                            <p>Get intelligent suggestions for activities, restaurants, and attractions based on real-time data.</p>
                        </div>
                        
                        <div class="feature-card animate__animated animate__fadeInUp" style="animation-delay: 0.4s;">
                            <div class="feature-icon">
                                <i class="fas fa-user-shield"></i>
                            </div>
                            <h3>Secure & Private</h3>
                            <p>Your data is protected with enterprise-grade security and end-to-end encryption.</p>
                        </div>
                        
                        <div class="feature-card animate__animated animate__fadeInUp" style="animation-delay: 0.5s;">
                            <div class="feature-icon">
                                <i class="fas fa-sync-alt"></i>
                            </div>
                            <h3>Real-time Updates</h3>
                            <p>Receive instant updates about weather, local events, and travel advisories for your destination.</p>
                        </div>
                    </div>
                </div>

                <!-- Popular Destinations -->
                <div class="destinations-section" id="destinations">
                    <div class="section-title">
                        <h2>Popular Destinations</h2>
                        <p>Explore our most loved travel destinations from around the world</p>
                    </div>
                    
                    <div class="destinations-grid">
                        <div class="destination-card animate__animated animate__fadeInUp">
                            <img src="https://images.unsplash.com/photo-1511739001486-6bfe10ce785f?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Paris, France">
                            <div class="destination-overlay">
                                <h3>Paris, France</h3>
                                <p>The city of love, art, and exquisite cuisine</p>
                            </div>
                        </div>
                        
                        <div class="destination-card animate__animated animate__fadeInUp" style="animation-delay: 0.1s;">
                            <img src="https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Tokyo, Japan">
                            <div class="destination-overlay">
                                <h3>Tokyo, Japan</h3>
                                <p>Where tradition meets cutting-edge technology</p>
                            </div>
                        </div>
                        
                        <div class="destination-card animate__animated animate__fadeInUp" style="animation-delay: 0.2s;">
                            <img src="https://images.unsplash.com/photo-1537996194471-e657df975ab4?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Bali, Indonesia">
                            <div class="destination-overlay">
                                <h3>Bali, Indonesia</h3>
                                <p>Tropical paradise with spiritual serenity</p>
                            </div>
                        </div>
                        
                        <div class="destination-card animate__animated animate__fadeInUp" style="animation-delay: 0.3s;">
                            <img src="https://images.unsplash.com/photo-1512453979798-5ea266f8880c?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="New York, USA">
                            <div class="destination-overlay">
                                <h3>New York, USA</h3>
                                <p>The city that never sleeps</p>
                            </div>
                        </div>
                        
                        <div class="destination-card animate__animated animate__fadeInUp" style="animation-delay: 0.4s;">
                            <img src="https://images.unsplash.com/photo-1520250497591-112f2f40a3f4?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Sydney, Australia">
                            <div class="destination-overlay">
                                <h3>Sydney, Australia</h3>
                                <p>Beautiful beaches and iconic landmarks</p>
                            </div>
                        </div>
                        
                        <div class="destination-card animate__animated animate__fadeInUp" style="animation-delay: 0.5s;">
                            <img src="https://images.unsplash.com/photo-1583422409516-2895a77efded?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Rome, Italy">
                            <div class="destination-overlay">
                                <h3>Rome, Italy</h3>
                                <p>Eternal city with ancient history</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Login Form -->
            <div class="form-container" id="login-form-container">
                <div class="form-header">
                    <h2>Welcome Back</h2>
                    <p>Login to access your travel itineraries</p>
                </div>
                <form id="login-form">
                    <div class="form-group">
                        <label for="login-email">Email Address</label>
                        <input type="email" id="login-email" class="form-control" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" class="form-control" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Login</button>
                </form>
                <div class="form-footer">
                    <p>Don't have an account? <a href="#" id="show-register">Sign up here</a></p>
                    <p class="mt-20" style="color: var(--light-blue); font-size: 0.9rem;">
                        <strong>Demo Users:</strong><br>
                        • test@example.com / test123<br>
                        • aditirajeshnair5@gmail.com / aditi12345
                    </p>
                </div>
            </div>

            <!-- Register Form -->
            <div class="form-container" id="register-form-container">
                <div class="form-header">
                    <h2>Create Account</h2>
                    <p>Join Voyager to start planning your trips</p>
                </div>
                <form id="register-form">
                    <div class="form-group">
                        <label for="register-name">Full Name</label>
                        <input type="text" id="register-name" class="form-control" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email Address</label>
                        <input type="email" id="register-email" class="form-control" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Password</label>
                        <input type="password" id="register-password" class="form-control" placeholder="Create a password (min. 8 characters)" required minlength="8">
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Create Account</button>
                </form>
                <div class="form-footer">
                    <p>Already have an account? <a href="#" id="show-login">Login here</a></p>
                </div>
            </div>

            <!-- Trip Planner Form -->
            <div class="form-container" id="trip-form-container">
                <div class="form-header">
                    <h2>Plan Your Adventure</h2>
                    <p>Tell us about your trip and we'll create a personalized itinerary</p>
                </div>
                <form id="trip-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="destination">Destination</label>
                            <input type="text" id="destination" class="form-control" placeholder="e.g., Paris, France" required>
                        </div>
                        <div class="form-group">
                            <label for="travel-days">Travel Days</label>
                            <input type="number" id="travel-days" class="form-control" placeholder="Number of days" min="1" max="30" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="budget">Budget Range</label>
                            <select id="budget" class="form-control" required>
                                <option value="" disabled selected>Select your budget range</option>
                                <option value="budget">Budget ($500 - $1500)</option>
                                <option value="moderate">Moderate ($1500 - $3000)</option>
                                <option value="luxury">Luxury ($3000+)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="travelers">Number of Travelers</label>
                            <input type="number" id="travelers" class="form-control" placeholder="How many people?" min="1" max="20" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Travel Interests (Select at least one)</label>
                        <div class="interests-container" id="interests-container">
                            <!-- Interests will be populated by JavaScript -->
                        </div>
                        <input type="hidden" id="selected-interests" required>
                    </div>
                    <div class="form-group">
                        <label for="additional-notes">Additional Notes (Optional)</label>
                        <textarea id="additional-notes" class="form-control" rows="4" placeholder="Any specific requirements, dietary restrictions, or special requests..."></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-robot"></i> Generate AI Itinerary
                    </button>
                </form>
            </div>

            <!-- Loading Animation -->
            <div class="loading" id="loading">
                <div class="loading-content">
                    <div class="spinner-container">
                        <div class="spinner"></div>
                        <div class="spinner-plane">
                            <i class="fas fa-plane"></i>
                        </div>
                    </div>
                    <h3>Creating your personalized itinerary...</h3>
                    <p>Our AI is analyzing your preferences and crafting the perfect trip plan.</p>
                    <div class="loading-progress">
                        <div class="loading-progress-bar"></div>
                    </div>
                </div>
            </div>

            <!-- Trip Results -->
            <div id="trip-results">
                <div class="trip-header">
                    <h2 id="trip-destination">Your Paris Itinerary</h2>
                    <p id="trip-summary">6-day luxury trip for 2 people</p>
                    <div class="trip-details">
                        <div class="detail-card">
                            <i class="fas fa-calendar-alt"></i>
                            <p>Duration</p>
                            <strong id="trip-days">6 Days</strong>
                        </div>
                        <div class="detail-card">
                            <i class="fas fa-users"></i>
                            <p>Travelers</p>
                            <strong id="trip-travelers">2 People</strong>
                        </div>
                        <div class="detail-card">
                            <i class="fas fa-wallet"></i>
                            <p>Budget</p>
                            <strong id="trip-budget">Luxury</strong>
                        </div>
                        <div class="detail-card">
                            <i class="fas fa-heart"></i>
                            <p>Interests</p>
                            <strong id="trip-interests">Sightseeing</strong>
                        </div>
                    </div>
                </div>

                <div class="itinerary-container" id="itinerary-container">
                    <!-- Day cards will be populated by JavaScript -->
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" id="save-trip-btn">
                        <i class="fas fa-save"></i> Save This Trip
                    </button>
                    <button class="btn btn-secondary" id="new-trip-btn">
                        <i class="fas fa-plus"></i> Plan Another Trip
                    </button>
                    <button class="btn btn-secondary" id="download-pdf-btn">
                        <i class="fas fa-download"></i> Download as PDF
                    </button>
                </div>
            </div>

            <!-- Previous Trips -->
            <div id="previous-trips-container">
                <div class="trips-header">
                    <h2>My Travel Archives</h2>
                    <p>All your saved itineraries in one place</p>
                </div>
                <div class="trips-grid" id="previous-trips-grid">
                    <!-- Previous trip cards will be populated by JavaScript -->
                </div>
                <div class="text-center mt-40">
                    <button class="btn btn-primary" id="back-to-planner-btn">
                        <i class="fas fa-arrow-left"></i> Back to Planner
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="logo-container">
                        <div class="logo">
                            <i class="fas fa-plane"></i>
                            Voyager
                        </div>
                    </div>
                    <p>Your intelligent travel companion for creating perfect itineraries using artificial intelligence.</p>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#home-page">Home</a></li>
                        <li><a href="#features">Features</a></li>
                        <li><a href="#destinations">Destinations</a></li>
                        <li><a href="#planner">Trip Planner</a></li>
                        <li><a href="#trips">My Trips</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact</h3>
                    <ul class="footer-links">
                        <li><i class="fas fa-envelope"></i> support@voyager.com</li>
                        <li><i class="fas fa-phone"></i> +1 (555) 123-4567</li>
                        <li><i class="fas fa-map-marker-alt"></i> 123 Travel Street, Adventure City</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Voyager. All rights reserved. | Designed for MCA Students</p>
            </div>
        </div>
    </footer>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // API Configuration - Update this with your backend URL
        const API_BASE_URL = 'http://localhost:5000';
        
        // Application State
        let currentUser = null;
        let userToken = null;
        let currentTrip = null;
        let isDarkTheme = true;
        let demoUsers = [
            { email: 'test@example.com', password: 'test123', name: 'Test User' },
            { email: 'aditirajeshnair5@gmail.com', password: 'aditi12345', name: 'Aditi Nair' }
        ];
        
        // DOM Elements
        const loginFormContainer = document.getElementById('login-form-container');
        const registerFormContainer = document.getElementById('register-form-container');
        const tripFormContainer = document.getElementById('trip-form-container');
        const tripResults = document.getElementById('trip-results');
        const previousTripsContainer = document.getElementById('previous-trips-container');
        const homePage = document.getElementById('home-page');
        const loadingElement = document.getElementById('loading');
        const notificationElement = document.getElementById('notification');
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = themeToggle.querySelector('i');
        
        // Buttons
        const loginBtn = document.getElementById('login-btn');
        const registerBtn = document.getElementById('register-btn');
        const startPlanningBtn = document.getElementById('start-planning-btn');
        const showRegisterLink = document.getElementById('show-register');
        const showLoginLink = document.getElementById('show-login');
        const saveTripBtn = document.getElementById('save-trip-btn');
        const newTripBtn = document.getElementById('new-trip-btn');
        const downloadPdfBtn = document.getElementById('download-pdf-btn');
        const backToPlannerBtn = document.getElementById('back-to-planner-btn');
        
        // Navigation
        const navHome = document.getElementById('nav-home');
        const navFeatures = document.getElementById('nav-features');
        const navDestinations = document.getElementById('nav-destinations');
        const navPlanner = document.getElementById('nav-planner');
        const navTrips = document.getElementById('nav-trips');
        
        // Forms
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const tripForm = document.getElementById('trip-form');
        
        // Interests data
        const interests = [
            'Sightseeing', 'Food & Dining', 'Adventure', 'Culture', 'Relaxation',
            'Shopping', 'Nightlife', 'Nature', 'History', 'Art & Museums',
            'Photography', 'Wellness', 'Family Friendly', 'Romantic', 'Budget Travel'
        ];
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Voyager application initialized');
            initializeInterests();
            checkAuthStatus();
            setupEventListeners();
            setupTheme();
            showHomePage();
            
            // Test backend connection
            testBackendConnection();
        });
        
        // Test backend connection
        async function testBackendConnection() {
            try {
                console.log('Testing backend connection to:', API_BASE_URL);
                const response = await fetch(`${API_BASE_URL}/health`);
                const data = await response.json();
                console.log('Backend connection test successful:', data);
                if (data.status === 'healthy') {
                    console.log('✅ Backend is running and connected to database');
                    return true;
                }
            } catch (error) {
                console.error('❌ Backend connection test failed:', error);
                showNotification('Backend is not reachable. Using demo mode.', 'warning');
                return false;
            }
        }
        
        // Set up theme toggle
        function setupTheme() {
            // Check saved theme preference
            const savedTheme = localStorage.getItem('voyager_theme');
            if (savedTheme === 'light') {
                setLightTheme();
            } else {
                setDarkTheme();
            }
            
            themeToggle.addEventListener('click', toggleTheme);
        }
        
        function toggleTheme() {
            if (isDarkTheme) {
                setLightTheme();
            } else {
                setDarkTheme();
            }
        }
        
        function setLightTheme() {
            document.body.classList.remove('dark-theme');
            themeIcon.className = 'fas fa-sun';
            isDarkTheme = false;
            localStorage.setItem('voyager_theme', 'light');
        }
        
        function setDarkTheme() {
            document.body.classList.add('dark-theme');
            themeIcon.className = 'fas fa-moon';
            isDarkTheme = true;
            localStorage.setItem('voyager_theme', 'dark');
        }
        
        // Set up all event listeners
        function setupEventListeners() {
            console.log('Setting up event listeners');
            
            // Auth buttons
            loginBtn.addEventListener('click', showLoginForm);
            registerBtn.addEventListener('click', showRegisterForm);
            showRegisterLink.addEventListener('click', showRegisterForm);
            showLoginLink.addEventListener('click', showLoginForm);
            
            // Navigation
            navHome.addEventListener('click', showHomePage);
            navFeatures.addEventListener('click', scrollToFeatures);
            navDestinations.addEventListener('click', scrollToDestinations);
            navPlanner.addEventListener('click', showTripPlanner);
            navTrips.addEventListener('click', showPreviousTrips);
            
            // Trip planning
            startPlanningBtn.addEventListener('click', showTripPlanner);
            newTripBtn.addEventListener('click', showTripPlanner);
            backToPlannerBtn.addEventListener('click', showTripPlanner);
            
            // Forms submission
            loginForm.addEventListener('submit', handleLogin);
            registerForm.addEventListener('submit', handleRegister);
            tripForm.addEventListener('submit', handleTripSubmit);
            
            // Trip actions
            saveTripBtn.addEventListener('click', saveTrip);
            downloadPdfBtn.addEventListener('click', downloadPdf);
        }
        
        // Initialize interests selection
        function initializeInterests() {
            const container = document.getElementById('interests-container');
            container.innerHTML = '';
            
            interests.forEach(interest => {
                const tag = document.createElement('div');
                tag.className = 'interest-tag';
                tag.textContent = interest;
                tag.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    updateSelectedInterests();
                });
                container.appendChild(tag);
            });
        }
        
        // Update hidden input with selected interests
        function updateSelectedInterests() {
            const selectedTags = document.querySelectorAll('.interest-tag.selected');
            const selectedInterests = Array.from(selectedTags).map(tag => tag.textContent);
            document.getElementById('selected-interests').value = selectedInterests.join(', ');
        }
        
        // Check if user is already logged in
        function checkAuthStatus() {
            console.log('Checking auth status');
            const token = localStorage.getItem('voyager_token');
            const user = localStorage.getItem('voyager_user');
            
            if (token && user) {
                try {
                    userToken = token;
                    currentUser = JSON.parse(user);
                    console.log('User found in localStorage:', currentUser.email);
                    updateAuthUI(true);
                } catch (error) {
                    console.error('Error parsing user data:', error);
                    clearAuthData();
                    updateAuthUI(false);
                }
            } else {
                console.log('No user found in localStorage');
                updateAuthUI(false);
            }
        }
        
        // Update UI based on authentication status
        function updateAuthUI(isLoggedIn) {
            console.log('Updating auth UI:', isLoggedIn);
            if (isLoggedIn) {
                loginBtn.innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
                loginBtn.onclick = handleLogout;
                registerBtn.classList.add('hidden');
            } else {
                loginBtn.innerHTML = 'Login';
                loginBtn.onclick = showLoginForm;
                registerBtn.classList.remove('hidden');
            }
        }
        
        // Clear authentication data
        function clearAuthData() {
            localStorage.removeItem('voyager_token');
            localStorage.removeItem('voyager_user');
            userToken = null;
            currentUser = null;
        }
        
        // Show home page
        function showHomePage(e) {
            if (e) e.preventDefault();
            hideAllContainers();
            homePage.style.display = 'block';
        }
        
        // Scroll to features
        function scrollToFeatures(e) {
            e.preventDefault();
            hideAllContainers();
            homePage.style.display = 'block';
            const featuresSection = document.getElementById('features');
            featuresSection.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Scroll to destinations
        function scrollToDestinations(e) {
            e.preventDefault();
            hideAllContainers();
            homePage.style.display = 'block';
            const destinationsSection = document.getElementById('destinations');
            destinationsSection.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Show login form
        function showLoginForm(e) {
            if (e) e.preventDefault();
            hideAllContainers();
            loginFormContainer.classList.add('active');
        }
        
        // Show register form
        function showRegisterForm(e) {
            if (e) e.preventDefault();
            hideAllContainers();
            registerFormContainer.classList.add('active');
        }
        
        // Show trip planner form
        function showTripPlanner(e) {
            if (e) e.preventDefault();
            if (!currentUser) {
                showLoginForm();
                showNotification('Please login to plan a trip', 'warning');
                return;
            }
            
            hideAllContainers();
            tripFormContainer.classList.add('active');
            
            // Reset form if coming from new trip button
            if (e && e.target.id === 'new-trip-btn') {
                tripForm.reset();
                document.querySelectorAll('.interest-tag.selected').forEach(tag => {
                    tag.classList.remove('selected');
                });
                updateSelectedInterests();
            }
        }
        
        // Show previous trips
        function showPreviousTrips(e) {
            if (e) e.preventDefault();
            if (!currentUser) {
                showLoginForm();
                showNotification('Please login to view your trips', 'warning');
                return;
            }
            
            hideAllContainers();
            previousTripsContainer.classList.add('active');
            loadPreviousTrips();
        }
        
        // Hide all content containers
        function hideAllContainers() {
            homePage.style.display = 'none';
            loginFormContainer.classList.remove('active');
            registerFormContainer.classList.remove('active');
            tripFormContainer.classList.remove('active');
            tripResults.classList.remove('active');
            previousTripsContainer.classList.remove('active');
            loadingElement.classList.remove('active');
        }
        
        // Handle login form submission
        async function handleLogin(e) {
            e.preventDefault();
            console.log('Login attempt started');
            
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            console.log('Login credentials:', { email: email, password: '***' });
            
            // Validate inputs
            if (!email || !password) {
                showNotification('Please enter both email and password', 'warning');
                return;
            }
            
            // Show loading state
            const submitBtn = loginForm.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Logging in...';
            submitBtn.disabled = true;
            
            // Check demo users first
            const demoUser = demoUsers.find(u => u.email === email && u.password === password);
            if (demoUser) {
                console.log('Using demo login for:', demoUser.email);
                userToken = `demo-jwt-token-${Date.now()}`;
                currentUser = {
                    id: Date.now(),
                    name: demoUser.name,
                    email: demoUser.email
                };
                
                localStorage.setItem('voyager_token', userToken);
                localStorage.setItem('voyager_user', JSON.stringify(currentUser));
                
                updateAuthUI(true);
                showTripPlanner();
                showNotification(`Welcome back ${demoUser.name}! (Demo Mode)`, 'success');
                loginForm.reset();
                
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                return;
            }
            
            try {
                console.log('Sending login request to backend:', `${API_BASE_URL}/login`);
                
                const response = await fetch(`${API_BASE_URL}/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        email: email,
                        password: password
                    })
                });
                
                console.log('Login response status:', response.status);
                
                let data;
                try {
                    data = await response.json();
                    console.log('Login response data:', data);
                } catch (parseError) {
                    console.error('Error parsing login response:', parseError);
                    throw new Error('Invalid response from server');
                }
                
                if (response.ok) {
                    if (!data.token || !data.user) {
                        throw new Error('Invalid response format from server');
                    }
                    
                    userToken = data.token;
                    currentUser = data.user;
                    
                    localStorage.setItem('voyager_token', userToken);
                    localStorage.setItem('voyager_user', JSON.stringify(currentUser));
                    
                    console.log('Login successful, user:', currentUser.email);
                    
                    updateAuthUI(true);
                    showTripPlanner();
                    showNotification('Login successful! Welcome back ' + currentUser.name, 'success');
                    loginForm.reset();
                } else {
                    console.error('Login failed:', data.message || 'Unknown error');
                    showNotification(data.message || 'Login failed. Please check your credentials.', 'error');
                }
            } catch (error) {
                console.error('Login network error:', error);
                
                if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                    console.log('Network error detected, checking if backend is running');
                    
                    const isBackendRunning = await testBackendConnection();
                    
                    if (!isBackendRunning) {
                        console.log('Backend not running, using demo mode');
                        showNotification('Backend is not available. Using demo mode.', 'warning');
                        
                        userToken = 'demo-jwt-token-' + Date.now();
                        currentUser = {
                            id: Date.now(),
                            name: email.split('@')[0],
                            email: email
                        };
                        
                        localStorage.setItem('voyager_token', userToken);
                        localStorage.setItem('voyager_user', JSON.stringify(currentUser));
                        
                        updateAuthUI(true);
                        showTripPlanner();
                        showNotification('Logged in with demo mode', 'info');
                        loginForm.reset();
                    } else {
                        showNotification('Network error. Please try again.', 'error');
                    }
                } else {
                    showNotification('Login error: ' + error.message, 'error');
                }
            } finally {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }
        
        // Handle registration form submission
        async function handleRegister(e) {
            e.preventDefault();
            console.log('Registration attempt started');
            
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            
            console.log('Registration data:', { name: name, email: email, password: '***' });
            
            if (!name || !email || !password) {
                showNotification('Please fill all fields', 'warning');
                return;
            }
            
            if (password.length < 8) {
                showNotification('Password must be at least 8 characters', 'warning');
                return;
            }
            
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showNotification('Please enter a valid email address', 'warning');
                return;
            }
            
            const submitBtn = registerForm.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating account...';
            submitBtn.disabled = true;
            
            try {
                console.log('Sending registration request to backend:', `${API_BASE_URL}/register`);
                
                const response = await fetch(`${API_BASE_URL}/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        name: name,
                        email: email,
                        password: password
                    })
                });
                
                console.log('Registration response status:', response.status);
                
                let data;
                try {
                    data = await response.json();
                    console.log('Registration response data:', data);
                } catch (parseError) {
                    console.error('Error parsing registration response:', parseError);
                    throw new Error('Invalid response from server');
                }
                
                if (response.ok) {
                    showNotification('Registration successful! Please login.', 'success');
                    showLoginForm();
                    registerForm.reset();
                } else {
                    console.error('Registration failed:', data.message || 'Unknown error');
                    showNotification(data.message || 'Registration failed. Please try again.', 'error');
                }
            } catch (error) {
                console.error('Registration network error:', error);
                
                if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                    console.log('Network error detected, using demo registration');
                    
                    const isBackendRunning = await testBackendConnection();
                    
                    if (!isBackendRunning) {
                        userToken = 'demo-jwt-token-' + Date.now();
                        currentUser = {
                            id: Date.now(),
                            name: name,
                            email: email
                        };
                        
                        localStorage.setItem('voyager_token', userToken);
                        localStorage.setItem('voyager_user', JSON.stringify(currentUser));
                        
                        updateAuthUI(true);
                        showTripPlanner();
                        showNotification('Account created in demo mode.', 'info');
                        registerForm.reset();
                    } else {
                        showNotification('Network error. Please try again.', 'error');
                    }
                } else {
                    showNotification('Registration error: ' + error.message, 'error');
                }
            } finally {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }
        
        // Handle logout
        function handleLogout() {
            console.log('Logging out user:', currentUser?.email);
            clearAuthData();
            currentTrip = null;
            updateAuthUI(false);
            showHomePage();
            showNotification('Logged out successfully', 'success');
        }
        
        // Handle trip form submission
        async function handleTripSubmit(e) {
            e.preventDefault();
            console.log('Trip planning started');
            
            if (!currentUser) {
                showLoginForm();
                showNotification('Please login to plan a trip', 'warning');
                return;
            }
            
            const destination = document.getElementById('destination').value;
            const travelDays = document.getElementById('travel-days').value;
            const budget = document.getElementById('budget').value;
            const travelers = document.getElementById('travelers').value;
            const selectedInterests = document.getElementById('selected-interests').value;
            const additionalNotes = document.getElementById('additional-notes').value;
            
            console.log('Trip data:', {
                destination,
                travelDays,
                budget,
                travelers,
                selectedInterests,
                additionalNotes
            });
            
            if (!destination || !travelDays || !budget || !travelers) {
                showNotification('Please fill all required fields', 'warning');
                return;
            }
            
            if (!selectedInterests) {
                showNotification('Please select at least one interest', 'warning');
                return;
            }
            
            hideAllContainers();
            loadingElement.classList.add('active');
            
            const tripData = {
                destination,
                travel_days: parseInt(travelDays),
                budget,
                travelers: parseInt(travelers),
                interests: selectedInterests,
                additional_notes: additionalNotes
            };
            
            try {
                console.log('Sending trip generation request to backend');
                
                const response = await fetch(`${API_BASE_URL}/generate-trip`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${userToken}`
                    },
                    body: JSON.stringify(tripData)
                });
                
                console.log('Trip generation response status:', response.status);
                
                let data;
                try {
                    data = await response.json();
                    console.log('Trip generation response data:', data);
                } catch (parseError) {
                    console.error('Error parsing trip generation response:', parseError);
                    throw new Error('Invalid response from server');
                }
                
                if (response.ok) {
                    currentTrip = data.trip;
                    displayTripResults(data.trip);
                    showNotification('Your itinerary has been generated!', 'success');
                } else {
                    throw new Error(data.message || 'Failed to generate trip');
                }
            } catch (error) {
                console.error('Trip generation error:', error);
                
                console.log('Using demo mode for trip generation');
                showNotification('Using demo mode for trip generation', 'info');
                
                const mockTrip = generateMockTrip(tripData);
                currentTrip = mockTrip;
                setTimeout(() => {
                    displayTripResults(mockTrip);
                    showNotification('Demo itinerary generated successfully!', 'success');
                }, 1500);
            }
        }
        
        // Display trip results
        function displayTripResults(trip) {
            hideAllContainers();
            console.log('Displaying trip results for:', trip.destination);
            
            document.getElementById('trip-destination').textContent = `Your ${trip.destination} Itinerary`;
            document.getElementById('trip-summary').textContent = `${trip.travel_days}-day ${trip.budget} trip for ${trip.travelers} people`;
            document.getElementById('trip-days').textContent = `${trip.travel_days} Days`;
            document.getElementById('trip-travelers').textContent = `${trip.travelers} People`;
            document.getElementById('trip-budget').textContent = trip.budget.charAt(0).toUpperCase() + trip.budget.slice(1);
            document.getElementById('trip-interests').textContent = trip.interests;
            
            const itineraryContainer = document.getElementById('itinerary-container');
            itineraryContainer.innerHTML = '';
            
            if (trip.itinerary && trip.itinerary.days) {
                trip.itinerary.days.forEach((day, index) => {
                    const dayCard = document.createElement('div');
                    dayCard.className = 'day-card animate__animated animate__fadeInUp';
                    dayCard.style.animationDelay = `${index * 0.1}s`;
                    
                    let activitiesHTML = '';
                    if (day.activities && day.activities.length > 0) {
                        day.activities.forEach(activity => {
                            activitiesHTML += `
                                <li>
                                    <div class="activity-icon">
                                        <i class="fas fa-${getActivityIcon(activity.type)}"></i>
                                    </div>
                                    <div class="activity-content">
                                        <span class="activity-time">${activity.time}</span>
                                        <p class="activity-desc">${activity.description}</p>
                                        ${activity.location ? `
                                            <div class="activity-location">
                                                <i class="fas fa-map-marker-alt"></i>
                                                ${activity.location}
                                            </div>
                                        ` : ''}
                                    </div>
                                </li>
                            `;
                        });
                    }
                    
                    dayCard.innerHTML = `
                        <div class="day-header">
                            <h3 class="day-title">Day ${index + 1}: ${day.title || `Day ${index + 1}`}</h3>
                            <span class="day-theme">${day.theme || 'Exploring'}</span>
                        </div>
                        <p class="mb-20">${day.summary || 'A day full of exciting activities.'}</p>
                        <ul class="day-activities">
                            ${activitiesHTML || '<li>No activities planned for this day.</li>'}
                        </ul>
                    `;
                    
                    itineraryContainer.appendChild(dayCard);
                });
            } else {
                itineraryContainer.innerHTML = `
                    <div class="day-card animate__animated animate__fadeInUp">
                        <div class="day-header">
                            <h3 class="day-title">AI Generated Itinerary</h3>
                        </div>
                        <p>${trip.itinerary_text || 'Your personalized itinerary has been created.'}</p>
                    </div>
                `;
            }
            
            tripResults.classList.add('active');
        }
        
        // Get appropriate icon for activity type
        function getActivityIcon(activityType) {
            const iconMap = {
                'breakfast': 'coffee',
                'lunch': 'utensils',
                'dinner': 'utensil-spoon',
                'sightseeing': 'camera',
                'museum': 'landmark',
                'shopping': 'shopping-bag',
                'walking': 'walking',
                'transport': 'bus',
                'hotel': 'hotel',
                'free': 'clock',
                'adventure': 'mountain',
                'nature': 'tree',
                'beach': 'umbrella-beach',
                'arrival': 'plane-arrival',
                'departure': 'plane-departure',
                'dining': 'utensils',
                'activity': 'hiking'
            };
            
            if (activityType && iconMap[activityType.toLowerCase()]) {
                return iconMap[activityType.toLowerCase()];
            }
            
            return 'map-marker-alt';
        }
        
        // Save current trip
        async function saveTrip() {
            if (!currentTrip || !currentUser) return;
            
            console.log('Saving trip:', currentTrip.destination);
            
            try {
                const response = await fetch(`${API_BASE_URL}/save-trip`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${userToken}`
                    },
                    body: JSON.stringify({
                        trip: currentTrip
                    })
                });
                
                let data;
                try {
                    data = await response.json();
                } catch (parseError) {
                    console.error('Error parsing save trip response:', parseError);
                    throw new Error('Invalid response from server');
                }
                
                if (response.ok) {
                    showNotification('Trip saved successfully!', 'success');
                    // Update trip ID with server response
                    if (data.trip_id) {
                        currentTrip.id = data.trip_id;
                    }
                } else {
                    throw new Error(data.message || 'Failed to save trip');
                }
            } catch (error) {
                console.error('Save trip error:', error);
                showNotification('Trip saved in demo mode', 'info');
            }
        }
        
        // Load previous trips
        async function loadPreviousTrips() {
            if (!currentUser) return;
            
            console.log('Loading previous trips for user:', currentUser.email);
            
            try {
                const response = await fetch(`${API_BASE_URL}/get-trips`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${userToken}`
                    }
                });
                
                let data;
                try {
                    data = await response.json();
                } catch (parseError) {
                    console.error('Error parsing get trips response:', parseError);
                    throw new Error('Invalid response from server');
                }
                
                if (response.ok) {
                    displayPreviousTrips(data.trips || []);
                } else {
                    throw new Error(data.message || 'Failed to load trips');
                }
            } catch (error) {
                console.error('Load trips error:', error);
                showNotification('Using demo data for previous trips', 'info');
                displayPreviousTrips(getMockTrips());
            }
        }
        
        // Display previous trips
        function displayPreviousTrips(trips) {
            const tripsGrid = document.getElementById('previous-trips-grid');
            
            if (trips.length === 0) {
                tripsGrid.innerHTML = `
                    <div class="text-center" style="grid-column: 1/-1; padding: 40px;">
                        <i class="fas fa-suitcase-rolling" style="font-size: 3rem; color: var(--light-blue); margin-bottom: 20px;"></i>
                        <h3 style="color: var(--gold);">No trips yet</h3>
                        <p style="color: var(--white);">You haven't saved any trips. Plan your first trip!</p>
                    </div>
                `;
                return;
            }
            
            tripsGrid.innerHTML = '';
            
            trips.forEach((trip, index) => {
                const tripCard = document.createElement('div');
                tripCard.className = 'trip-card animate__animated animate__fadeInUp';
                tripCard.style.animationDelay = `${index * 0.1}s`;
                
                const createdDate = trip.created_at ? new Date(trip.created_at).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                }) : 'Recently';
                
                tripCard.innerHTML = `
                    <h4>${trip.destination}</h4>
                    <p><i class="fas fa-calendar-alt"></i> ${trip.travel_days} days</p>
                    <p><i class="fas fa-users"></i> ${trip.travelers} travelers</p>
                    <p><i class="fas fa-wallet"></i> ${trip.budget.charAt(0).toUpperCase() + trip.budget.slice(1)}</p>
                    <p><i class="fas fa-heart"></i> ${trip.interests}</p>
                    <p class="trip-date"><i class="far fa-clock"></i> Created: ${createdDate}</p>
                    <div class="trip-actions">
                        <button class="btn btn-small btn-secondary" onclick="viewSavedTrip(${trip.id})">
                            <i class="fas fa-eye"></i> View
                        </button>
                        <button class="btn btn-small btn-primary" onclick="downloadTripAsPDF(${trip.id})">
                            <i class="fas fa-download"></i> PDF
                        </button>
                    </div>
                `;
                
                tripsGrid.appendChild(tripCard);
            });
        }
        
        // View saved trip details
        async function viewSavedTrip(tripId) {
            console.log('Viewing trip details for ID:', tripId);
            
            try {
                const response = await fetch(`${API_BASE_URL}/get-trip/${tripId}`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${userToken}`
                    }
                });
                
                let data;
                try {
                    data = await response.json();
                } catch (parseError) {
                    console.error('Error parsing get trip response:', parseError);
                    throw new Error('Invalid response from server');
                }
                
                if (response.ok) {
                    currentTrip = data.trip;
                    displayTripResults(data.trip);
                } else {
                    throw new Error(data.message || 'Failed to load trip');
                }
            } catch (error) {
                console.error('View trip error:', error);
                showNotification('Loading demo trip details', 'info');
                
                const mockTrip = getMockTripById(tripId);
                if (mockTrip) {
                    currentTrip = mockTrip;
                    displayTripResults(mockTrip);
                } else {
                    showNotification('Trip not found', 'error');
                }
            }
        }
        
        // Download trip as PDF
        async function downloadTripAsPDF(tripId) {
            console.log('Downloading trip as PDF for ID:', tripId);
            
            try {
                const response = await fetch(`${API_BASE_URL}/get-trip/${tripId}`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${userToken}`
                    }
                });
                
                let data;
                try {
                    data = await response.json();
                } catch (parseError) {
                    console.error('Error parsing get trip response:', parseError);
                    throw new Error('Invalid response from server');
                }
                
                if (response.ok) {
                    generatePDF(data.trip);
                } else {
                    throw new Error(data.message || 'Failed to load trip');
                }
            } catch (error) {
                console.error('Download trip error:', error);
                showNotification('Generating demo PDF', 'info');
                
                const mockTrip = getMockTripById(tripId) || currentTrip;
                if (mockTrip) {
                    generatePDF(mockTrip);
                } else {
                    showNotification('No trip data available', 'error');
                }
            }
        }
        
        // Generate PDF from trip data
        function generatePDF(trip) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add title
            doc.setFontSize(24);
            doc.setTextColor(26, 35, 126);
            doc.text(`Voyager Itinerary: ${trip.destination}`, 105, 20, null, null, 'center');
            
            // Add trip details
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            
            let yPosition = 40;
            
            // Trip summary
            doc.setFontSize(14);
            doc.setTextColor(255, 215, 0);
            doc.text('Trip Summary', 20, yPosition);
            
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            yPosition += 10;
            doc.text(`Destination: ${trip.destination}`, 20, yPosition);
            yPosition += 7;
            doc.text(`Duration: ${trip.travel_days} days`, 20, yPosition);
            yPosition += 7;
            doc.text(`Travelers: ${trip.travelers} people`, 20, yPosition);
            yPosition += 7;
            doc.text(`Budget: ${trip.budget.charAt(0).toUpperCase() + trip.budget.slice(1)}`, 20, yPosition);
            yPosition += 7;
            doc.text(`Interests: ${trip.interests}`, 20, yPosition);
            
            yPosition += 15;
            
            // Itinerary
            if (trip.itinerary && trip.itinerary.days) {
                doc.setFontSize(14);
                doc.setTextColor(255, 215, 0);
                doc.text('Daily Itinerary', 20, yPosition);
                yPosition += 10;
                
                trip.itinerary.days.forEach((day, index) => {
                    if (yPosition > 250) {
                        doc.addPage();
                        yPosition = 20;
                    }
                    
                    doc.setFontSize(12);
                    doc.setTextColor(26, 35, 126);
                    doc.text(`Day ${index + 1}: ${day.title || ''}`, 20, yPosition);
                    yPosition += 7;
                    
                    doc.setFontSize(10);
                    doc.setTextColor(0, 0, 0);
                    doc.text(day.summary || '', 20, yPosition);
                    yPosition += 7;
                    
                    if (day.activities) {
                        day.activities.forEach(activity => {
                            if (yPosition > 250) {
                                doc.addPage();
                                yPosition = 20;
                            }
                            doc.text(`• ${activity.time}: ${activity.description}`, 25, yPosition);
                            yPosition += 6;
                        });
                    }
                    
                    yPosition += 10;
                });
            }
            
            // Add footer
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(10);
                doc.setTextColor(128, 128, 128);
                doc.text(`Page ${i} of ${pageCount}`, 105, 285, null, null, 'center');
                doc.text('Generated by Voyager AI Travel Planner', 105, 290, null, null, 'center');
            }
            
            // Save the PDF
            doc.save(`voyager-itinerary-${trip.destination.toLowerCase().replace(/\s+/g, '-')}.pdf`);
            showNotification('PDF downloaded successfully!', 'success');
        }
        
        // Download PDF for current trip
        function downloadPdf() {
            if (!currentTrip) {
                showNotification('No trip to download', 'warning');
                return;
            }
            generatePDF(currentTrip);
        }
        
        // Show notification
        function showNotification(message, type = 'info') {
            console.log('Notification:', type, message);
            notificationElement.textContent = message;
            notificationElement.className = `notification ${type}`;
            notificationElement.classList.add('show');
            
            let icon = 'info-circle';
            if (type === 'success') icon = 'check-circle';
            if (type === 'error') icon = 'exclamation-circle';
            if (type === 'warning') icon = 'exclamation-triangle';
            
            notificationElement.innerHTML = `<i class="fas fa-${icon}"></i> ${message}`;
            
            setTimeout(() => {
                notificationElement.classList.remove('show');
            }, 5000);
        }
        
        // Mock data functions for demo mode
        function generateMockTrip(tripData) {
            const { destination, travel_days, budget, travelers, interests } = tripData;
            
            const days = [];
            for (let i = 1; i <= travel_days; i++) {
                if (i === 1) {
                    days.push({
                        day: i,
                        title: `Arrival in ${destination}`,
                        summary: `Welcome to ${destination}! Settle in and start your adventure.`,
                        theme: 'Arrival & Orientation',
                        activities: [
                            {
                                time: '2:00 PM',
                                type: 'arrival',
                                description: 'Arrive at airport and transfer to accommodation',
                                location: 'Airport to Hotel'
                            },
                            {
                                time: '4:00 PM',
                                type: 'sightseeing',
                                description: 'Orientation walk around the neighborhood',
                                location: 'City Center'
                            },
                            {
                                time: '7:30 PM',
                                type: 'dinner',
                                description: 'Welcome dinner featuring local cuisine',
                                location: 'Traditional Restaurant'
                            }
                        ]
                    });
                } else if (i === travel_days) {
                    days.push({
                        day: i,
                        title: `Departure from ${destination}`,
                        summary: 'Last day to explore before your journey home.',
                        theme: 'Departure',
                        activities: [
                            {
                                time: '9:00 AM',
                                type: 'breakfast',
                                description: 'Final breakfast and packing',
                                location: 'Hotel'
                            },
                            {
                                time: '11:00 AM',
                                type: 'shopping',
                                description: 'Souvenir shopping and last-minute exploration',
                                location: 'Local Market'
                            },
                            {
                                time: '2:00 PM',
                                type: 'departure',
                                description: 'Transfer to airport for departure',
                                location: 'Hotel to Airport'
                            }
                        ]
                    });
                } else {
                    days.push({
                        day: i,
                        title: `Exploring ${destination}`,
                        summary: `Full day of adventures based on your interests: ${interests}`,
                        theme: 'Exploration',
                        activities: [
                            {
                                time: '8:00 AM',
                                type: 'breakfast',
                                description: 'Breakfast with local specialties',
                                location: 'Hotel/Cafe'
                            },
                            {
                                time: '10:00 AM',
                                type: 'sightseeing',
                                description: 'Visit major landmarks and attractions',
                                location: 'Various Locations'
                            },
                            {
                                time: '1:00 PM',
                                type: 'lunch',
                                description: 'Lunch at a recommended local restaurant',
                                location: 'Authentic Restaurant'
                            },
                            {
                                time: '3:00 PM',
                                type: activitiesBasedOnInterests(interests),
                                description: `Activity focused on ${interests.split(',')[0].trim()}`,
                                location: 'Activity Center'
                            },
                            {
                                time: '7:00 PM',
                                type: 'dinner',
                                description: 'Evening dining experience',
                                location: 'Fine Dining Restaurant'
                            }
                        ]
                    });
                }
            }
            
            return {
                id: Date.now(),
                destination,
                travel_days,
                budget,
                travelers,
                interests,
                itinerary: {
                    days,
                    summary: `A ${travel_days}-day ${budget} trip to ${destination} for ${travelers} people interested in ${interests}.`,
                    estimated_cost: estimateCost(budget, travel_days, travelers),
                    travel_tips: [
                        'Book activities in advance during peak season',
                        'Try local transportation for authentic experience',
                        'Carry local currency for small purchases',
                        'Respect local customs and traditions'
                    ]
                },
                created_at: new Date().toISOString()
            };
        }
        
        function activitiesBasedOnInterests(interests) {
            const interest = interests.split(',')[0].trim().toLowerCase();
            if (interest.includes('adventure')) return 'adventure';
            if (interest.includes('food')) return 'dining';
            if (interest.includes('culture') || interest.includes('history')) return 'museum';
            if (interest.includes('nature')) return 'nature';
            if (interest.includes('shopping')) return 'shopping';
            if (interest.includes('relaxation')) return 'beach';
            return 'sightseeing';
        }
        
        function estimateCost(budget, days, travelers) {
            const dailyCost = {
                'budget': 80,
                'moderate': 150,
                'luxury': 300
            };
            
            const costPerPerson = dailyCost[budget] * days;
            return costPerPerson * travelers;
        }
        
        function getMockTrips() {
            return [
                {
                    id: 1,
                    destination: 'Paris, France',
                    travel_days: 5,
                    budget: 'moderate',
                    travelers: 2,
                    interests: 'Sightseeing, Food, Culture',
                    created_at: '2024-01-15T10:30:00Z'
                },
                {
                    id: 2,
                    destination: 'Tokyo, Japan',
                    travel_days: 7,
                    budget: 'luxury',
                    travelers: 4,
                    interests: 'Food, Culture, Technology',
                    created_at: '2024-02-20T14:45:00Z'
                },
                {
                    id: 3,
                    destination: 'Bali, Indonesia',
                    travel_days: 8,
                    budget: 'budget',
                    travelers: 1,
                    interests: 'Nature, Relaxation, Adventure',
                    created_at: '2024-03-10T09:15:00Z'
                }
            ];
        }
        
        function getMockTripById(tripId) {
            const mockTrips = getMockTrips();
            const trip = mockTrips.find(t => t.id === tripId);
            if (trip) {
                return generateMockTrip(trip);
            }
            return null;
        }
        
        // Export functions for use in HTML onclick attributes
        window.viewSavedTrip = viewSavedTrip;
        window.downloadTripAsPDF = downloadTripAsPDF;
    </script>
</body>
</html>